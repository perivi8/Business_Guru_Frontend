<!-- Transaction Details Page -->
<div class="min-h-screen bg-gray-50">
  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    
    <!-- Loading State -->
    <div *ngIf="loading" class="flex flex-col items-center justify-center py-12">
      <mat-spinner diameter="40" class="mb-4"></mat-spinner>
      <p class="text-gray-600 font-medium">Loading client transactions...</p>
    </div>

    <!-- Error State -->
    <div *ngIf="error" class="flex items-center justify-center py-12">
      <div class="text-center">
        <div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4">
          <mat-icon class="text-red-600 text-4xl">error</mat-icon>
        </div>
        <h3 class="text-lg font-semibold text-gray-900 mb-2">Error Loading Data</h3>
        <p class="text-red-600 mb-4">{{ error }}</p>
        <button mat-raised-button color="primary" (click)="loadApprovedClients()" class="btn btn-primary">
          <mat-icon class="mr-2">refresh</mat-icon>
          Try Again
        </button>
      </div>
    </div>

    <!-- No Clients State -->
    <div *ngIf="!loading && !error && approvedClients.length === 0" class="flex flex-col items-center justify-center py-16">
      <div class="w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-6">
        <mat-icon class="text-gray-400 text-6xl">verified_user</mat-icon>
      </div>
      <h3 class="text-xl font-semibold text-gray-900 mb-2">No Approved Clients Found</h3>
      <p class="text-gray-600 text-center max-w-md">There are currently no clients with approved loan status.</p>
      <button mat-raised-button (click)="goBack()" class="mt-4">
        <mat-icon class="mr-2">arrow_back</mat-icon>
        Go Back
      </button>
    </div>

    <!-- Transaction Details for First Client -->
    <div *ngIf="!loading && !error && approvedClients.length > 0 && selectedClient" class="space-y-6">
      
      <!-- Header with Client Name and Actions -->
      <div class="bg-green-50 rounded-2xl p-6 border border-green-200">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-3">
            <div class="w-10 h-10 bg-green-500 rounded-full flex items-center justify-center">
              <mat-icon class="text-white">person</mat-icon>
            </div>
            <h1 class="text-xl font-bold text-gray-900">Transactions for {{ getClientDisplayName(selectedClient) }}</h1>
          </div>
          <div class="flex items-center gap-3">
            <button (click)="addTransaction()" 
                    class="inline-flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
              <mat-icon class="mr-2 text-sm">add</mat-icon>
              Add Transaction
            </button>
            <button (click)="goBack()" 
                    class="inline-flex items-center justify-center w-10 h-10 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-gray-300">
              <mat-icon class="text-xl">close</mat-icon>
            </button>
          </div>
        </div>
      </div>

      <!-- Summary Cards -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Total Transactions Card -->
        <div class="bg-white rounded-xl p-6 border border-gray-200 shadow-sm">
          <div class="flex items-center gap-3">
            <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
              <mat-icon class="text-green-600">receipt</mat-icon>
            </div>
            <div>
              <p class="text-sm text-gray-600">Total Transactions</p>
              <p class="text-3xl font-bold text-gray-900">{{ clientTransactions.length }}</p>
            </div>
          </div>
        </div>

        <!-- Total Amount Card -->
        <div class="bg-white rounded-xl p-6 border border-gray-200 shadow-sm">
          <div class="flex items-center gap-3">
            <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
              <mat-icon class="text-blue-600">currency_rupee</mat-icon>
            </div>
            <div>
              <p class="text-sm text-gray-600">Total Amount</p>
              <p class="text-3xl font-bold text-blue-600">₹{{ getTotalTransactionAmount(selectedClient._id) | number:'1.2-2' }}</p>
            </div>
          </div>
        </div>
      </div>

      <!-- No Transactions Message -->
      <div *ngIf="clientTransactions.length === 0" class="bg-white rounded-xl p-12 text-center border border-gray-200">
        <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
          <mat-icon class="text-gray-400 text-4xl">receipt_long</mat-icon>
        </div>
        <h3 class="text-lg font-semibold text-gray-900 mb-2">No transactions found</h3>
        <p class="text-gray-600 mb-6">This client doesn't have any transactions yet.</p>
        <button (click)="addTransaction()" 
                class="inline-flex items-center px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
          <mat-icon class="mr-2 text-sm">add</mat-icon>
          Add First Transaction
        </button>
      </div>

      <!-- Transactions Table -->
      <div *ngIf="clientTransactions.length > 0" class="bg-white rounded-xl border border-gray-200 overflow-hidden">
        <div class="overflow-x-auto">
          <table class="w-full">
            <thead class="bg-gray-50">
              <tr>
                <th class="text-left py-4 px-6 font-semibold text-gray-700">Date</th>
                <th class="text-left py-4 px-6 font-semibold text-gray-700">Order ID</th>
                <th class="text-left py-4 px-6 font-semibold text-gray-700">Amount</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let transaction of clientTransactions" class="border-t border-gray-100 hover:bg-gray-50">
                <td class="py-4 px-6">
                  <div class="flex items-center gap-2">
                    <mat-icon class="text-blue-500 text-sm">calendar_today</mat-icon>
                    <span class="font-medium text-gray-900">{{ transaction.date | date:'mediumDate' }}</span>
                  </div>
                </td>
                <td class="py-4 px-6">
                  <div class="flex items-center gap-2">
                    <mat-icon class="text-purple-500 text-sm">confirmation_number</mat-icon>
                    <span class="font-mono text-sm bg-purple-100 text-purple-800 px-2 py-1 rounded">{{ transaction.orderId }}</span>
                  </div>
                </td>
                <td class="py-4 px-6">
                  <div class="flex items-center gap-2">
                    <mat-icon class="text-green-500 text-sm">currency_rupee</mat-icon>
                    <span class="font-bold text-green-600 text-lg">₹{{ transaction.amount | number:'1.2-2' }}</span>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>
