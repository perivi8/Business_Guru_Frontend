<!-- Modern Dialog Container -->
<div class="max-w-4xl mx-auto">
  <!-- Dialog Header -->
  <div class="flex items-center justify-between p-6 border-b border-gray-200 bg-gradient-to-r from-primary/5 to-secondary/5">
    <div class="flex flex-col">
      <h2 class="text-xl font-bold text-text-primary">Client Details</h2>
      <div *ngIf="client.enquiry_id" class="flex items-center gap-2 mt-1">
        <span class="text-sm text-gray-600">From Enquiry:</span>
        <span class="bg-blue-100 text-blue-800 text-xs font-medium px-2 py-1 rounded-full">
          ID: {{ client.enquiry_id }}
        </span>
      </div>
    </div>
    <button (click)="onClose()" 
            class="w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center transition-colors"
            title="Close">
      <svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
      </svg>
    </button>
  </div>

  <div class="p-6 max-h-[70vh] overflow-y-auto">
    <!-- Client Summary -->
    <div class="bg-white rounded-xl shadow-sm border border-border-light p-6 mb-6">
      <div class="flex items-start gap-4">
        <div class="w-16 h-16 rounded-2xl bg-gradient-to-br from-primary to-secondary flex items-center justify-center shadow-lg flex-shrink-0"
             [ngClass]="{'bg-gray-200': !client.legal_name && !client.user_name}">
          <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
          </svg>
        </div>
        <div class="flex-1 min-w-0">
          <h3 class="text-lg font-bold text-text-primary mb-2"
              [ngClass]="{'text-gray-400': !client.legal_name && !client.user_name}">
            {{ client.legal_name || client.user_name || 'Client Name Not Provided' }}
          </h3>
          <div class="space-y-2 mb-3">
            <div class="flex items-center gap-2 text-sm"
                 [ngClass]="{'text-gray-400': !client.email}">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
              </svg>
              <span>{{ client.email || 'Email Not Provided' }}</span>
            </div>
            <div class="flex items-center gap-2 text-sm"
                 [ngClass]="{'text-gray-400': !client.mobile_number}">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
              </svg>
              <span>{{ client.mobile_number || 'Phone Not Provided' }}</span>
            </div>
          </div>
          <div class="flex flex-wrap gap-2">
            <span class="px-3 py-1 text-xs rounded-full font-medium text-white"
                  [style.background-color]="getStatusColor(client.status)">
              {{ client.status ? (client.status | titlecase) : 'Status: N/A' }}
            </span>
            <span class="px-3 py-1 text-xs rounded-full font-medium text-white"
                  [style.background-color]="getLoanStatusColor(getLoanStatus())">
              Loan Status: {{ getLoanStatus() | titlecase }}
            </span>
          </div>
        </div>
      </div>
    </div>

    <!-- Information Sections -->
    <div class="space-y-6">
      <!-- Personal Information -->
      <div *ngIf="hasPersonalInfo()" class="bg-white rounded-xl shadow-sm border border-border-light overflow-hidden">
        <div class="p-4 border-b border-border-light">
          <div class="flex items-center gap-3">
            <div class="w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center">
              <svg class="w-5 h-5 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
              </svg>
            </div>
            <h3 class="text-lg font-semibold text-text-primary">Personal Information</h3>
          </div>
        </div>
        <div class="p-4">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div *ngIf="client.legal_name" class="flex justify-between py-2 border-b border-gray-100">
              <span class="text-sm font-medium text-text-secondary">Legal Name:</span>
              <span class="text-sm text-text-primary">{{ client.legal_name }}</span>
            </div>
            <div *ngIf="client['optional_mobile_number']" class="flex justify-between py-2 border-b border-gray-100">
              <span class="text-sm font-medium text-text-secondary">Optional Mobile:</span>
              <span class="text-sm text-text-primary">{{ client['optional_mobile_number'] }}</span>
            </div>
            <div *ngIf="client.email" class="flex justify-between py-2 border-b border-gray-100">
              <span class="text-sm font-medium text-text-secondary">Email:</span>
              <span class="text-sm text-text-primary">{{ client.email }}</span>
            </div>
            <div *ngIf="client.mobile_number" class="flex justify-between py-2 border-b border-gray-100">
              <span class="text-sm font-medium text-text-secondary">Mobile:</span>
              <span class="text-sm text-text-primary">{{ client.mobile_number }}</span>
            </div>
            <div *ngIf="client.date_of_birth" class="flex justify-between py-2 border-b border-gray-100">
              <span class="text-sm font-medium text-text-secondary">Date of Birth:</span>
              <span class="text-sm text-text-primary">{{ formatDate(client.date_of_birth) }}</span>
            </div>
            <div *ngIf="client.gender" class="flex justify-between py-2 border-b border-gray-100">
              <span class="text-sm font-medium text-text-secondary">Gender:</span>
              <span class="text-sm text-text-primary">{{ client.gender }}</span>
            </div>
            <div *ngIf="hasValue(client.address) || hasValue(client.district) || hasValue(client.state) || hasValue(client.pincode)" 
                 class="md:col-span-2 flex justify-between py-2">
              <span class="text-sm font-medium text-text-secondary">Address:</span>
              <span class="text-sm text-text-primary text-right max-w-xs">{{ formatAddress() }}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Business Information -->
      <div *ngIf="hasBusinessInfo()" class="bg-white rounded-xl shadow-sm border border-border-light overflow-hidden">
        <div class="p-4 border-b border-border-light">
          <div class="flex items-center gap-3">
            <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center">
              <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
              </svg>
            </div>
            <h3 class="text-lg font-semibold text-text-primary">Business Information</h3>
          </div>
        </div>
        <div class="p-4">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div *ngIf="client.business_name" class="flex justify-between py-2 border-b border-gray-100">
              <span class="text-sm font-medium text-text-secondary">Business Name:</span>
              <span class="text-sm text-text-primary">{{ client.business_name }}</span>
            </div>
            <div *ngIf="client['legal_business_name']" class="flex justify-between py-2 border-b border-gray-100">
              <span class="text-sm font-medium text-text-secondary">Legal Business Name:</span>
              <span class="text-sm text-text-primary">{{ client['legal_business_name'] }}</span>
            </div>
            <div *ngIf="client.business_type" class="flex justify-between py-2 border-b border-gray-100">
              <span class="text-sm font-medium text-text-secondary">Business Type:</span>
              <span class="text-sm text-text-primary">{{ client.business_type }}</span>
            </div>
            <div *ngIf="client['constitution_type']" class="flex justify-between py-2 border-b border-gray-100">
              <span class="text-sm font-medium text-text-secondary">Constitution Type:</span>
              <span class="text-sm text-text-primary">{{ client['constitution_type'] }}</span>
            </div>
            <div *ngIf="client['has_business_pan']" class="flex justify-between py-2 border-b border-gray-100">
              <span class="text-sm font-medium text-text-secondary">Has Business PAN:</span>
              <span class="text-sm text-text-primary">{{ client['has_business_pan'] }}</span>
            </div>
            <div *ngIf="client['number_of_partners'] !== undefined" class="flex justify-between py-2 border-b border-gray-100">
              <span class="text-sm font-medium text-text-secondary">Number of Partners:</span>
              <span class="text-sm text-text-primary">{{ client['number_of_partners'] }}</span>
            </div>
            <div *ngIf="client['business_pan']" class="flex justify-between py-2 border-b border-gray-100">
              <span class="text-sm font-medium text-text-secondary">Business PAN:</span>
              <span class="text-sm text-text-primary">{{ client['business_pan'] }}</span>
            </div>
            <div *ngIf="client['ie_code']" class="flex justify-between py-2 border-b border-gray-100">
              <span class="text-sm font-medium text-text-secondary">IE Code:</span>
              <span class="text-sm text-text-primary">{{ client['ie_code'] }}</span>
            </div>
            <div *ngIf="client['website']" class="flex justify-between py-2 border-b border-gray-100">
              <span class="text-sm font-medium text-text-secondary">Website:</span>
              <span class="text-sm text-primary hover:text-primary-dark">
                <a [href]="client['website']" target="_blank" rel="noopener">{{ client['website'] }}</a>
              </span>
            </div>
            <div *ngIf="client.business_address" class="md:col-span-2 flex justify-between py-2">
              <span class="text-sm font-medium text-text-secondary">Business Address:</span>
              <span class="text-sm text-text-primary text-right max-w-xs">{{ client.business_address }}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Banking Information -->
      <div *ngIf="hasBankingInfo()" class="bg-white rounded-xl shadow-sm border border-border-light overflow-hidden">
        <div class="p-4 border-b border-border-light">
          <div class="flex items-center gap-3">
            <div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center">
              <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
            </div>
            <h3 class="text-lg font-semibold text-text-primary">Banking Information</h3>
          </div>
        </div>
        <div class="p-4">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div *ngIf="client['bank_name']" class="flex justify-between py-2 border-b border-gray-100">
              <span class="text-sm font-medium text-text-secondary">Bank Name:</span>
              <span class="text-sm text-text-primary">{{ client['bank_name'] }}</span>
            </div>
            <div *ngIf="client['account_number']" class="flex justify-between py-2 border-b border-gray-100">
              <span class="text-sm font-medium text-text-secondary">Account Number:</span>
              <span class="text-sm text-text-primary">{{ client['account_number'] }}</span>
            </div>
            <div *ngIf="client['ifsc_code']" class="flex justify-between py-2 border-b border-gray-100">
              <span class="text-sm font-medium text-text-secondary">IFSC Code:</span>
              <span class="text-sm text-text-primary">{{ client['ifsc_code'] }}</span>
            </div>
            <div *ngIf="client['account_type'] !== undefined" class="flex justify-between py-2 border-b border-gray-100">
              <span class="text-sm font-medium text-text-secondary">Account Type:</span>
              <span class="text-sm text-text-primary">{{ client['account_type'] }}</span>
            </div>
            <div *ngIf="client['new_current_account']" class="flex justify-between py-2">
              <span class="text-sm font-medium text-text-secondary">New Current Account:</span>
              <span class="text-sm text-text-primary">{{ client['new_current_account'] }}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Loan Status Section -->
      <div class="bg-white rounded-xl shadow-sm border border-border-light overflow-hidden">
        <div class="p-4 border-b border-border-light">
          <div class="flex items-center gap-3">
            <div class="w-8 h-8 bg-cyan-100 rounded-lg flex items-center justify-center">
              <svg class="w-5 h-5 text-cyan-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
              </svg>
            </div>
            <h3 class="text-lg font-semibold text-text-primary">Loan Status</h3>
          </div>
        </div>
        <div class="p-4">
          <div class="space-y-4">
            <div class="flex justify-between items-center py-2 border-b border-gray-100">
              <span class="text-sm font-medium text-text-secondary">Current Loan Status:</span>
              <span class="px-3 py-1 text-xs rounded-full font-medium text-white"
                    [style.background-color]="getLoanStatusColor(getLoanStatus())">
                {{ getLoanStatus() | titlecase }}
              </span>
            </div>
            <div class="flex justify-between items-center py-2 border-b border-gray-100">
              <span class="text-sm font-medium text-text-secondary">Update Loan Status:</span>
              <div class="w-48">
                <select [(ngModel)]="selectedLoanStatus" 
                        (change)="onLoanStatusChange($event)"
                        class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 hover:border-gray-400 transition-colors">
                  <option value="soon">Soon</option>
                  <option value="processing">Processing</option>
                  <option value="approved">Approved</option>
                  <option value="hold">Hold</option>
                  <option value="rejected">Rejected</option>
                </select>
              </div>
            </div>
            <div *ngIf="client.required_loan_amount" class="flex justify-between py-2 border-b border-gray-100">
              <span class="text-sm font-medium text-text-secondary">Required Loan Amount:</span>
              <span class="text-sm text-text-primary font-semibold">â‚¹{{ client.required_loan_amount | number }}</span>
            </div>
            <div *ngIf="client.loan_purpose" class="flex justify-between py-2">
              <span class="text-sm font-medium text-text-secondary">Loan Purpose:</span>
              <span class="text-sm text-text-primary">{{ client.loan_purpose }}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Documents Section -->
      <div *ngIf="hasDocuments()" class="bg-white rounded-xl shadow-sm border border-border-light overflow-hidden">
        <div class="p-4 border-b border-border-light">
          <div class="flex items-center gap-3">
            <div class="w-8 h-8 bg-orange-100 rounded-lg flex items-center justify-center">
              <svg class="w-5 h-5 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"></path>
              </svg>
            </div>
            <h3 class="text-lg font-semibold text-text-primary">Documents</h3>
          </div>
        </div>
        <div class="p-4">
          <div class="space-y-3">
            <div *ngFor="let docType of getDocumentTypes()" class="flex items-center justify-between p-3 bg-gray-50 rounded-lg border border-gray-200 hover:shadow-sm transition-shadow">
              <div class="flex items-center gap-3">
                <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center">
                  <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                  </svg>
                </div>
                <span class="text-sm font-medium text-text-primary">{{ getDocumentName(docType) }}</span>
              </div>
              <div class="flex items-center gap-1">
                <button (click)="previewDocument(docType)" 
                        class="w-8 h-8 rounded-lg bg-blue-100 hover:bg-blue-200 flex items-center justify-center transition-colors"
                        [title]="'Preview ' + getDocumentName(docType)">
                  <svg class="w-4 h-4 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                  </svg>
                </button>
                <button (click)="downloadDocument(docType)" 
                        class="w-8 h-8 rounded-lg bg-green-100 hover:bg-green-200 flex items-center justify-center transition-colors"
                        [title]="'Download ' + getDocumentName(docType)">
                  <svg class="w-4 h-4 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                  </svg>
                </button>
                <button *ngIf="hasDocument(docType)"
                        (click)="openInNewTab(docType)" 
                        class="w-8 h-8 rounded-lg bg-purple-100 hover:bg-purple-200 flex items-center justify-center transition-colors"
                        [title]="'Open ' + getDocumentName(docType) + ' in new tab'">
                  <svg class="w-4 h-4 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
                  </svg>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- No Documents Message -->
      <div *ngIf="!hasDocuments()" class="bg-white rounded-xl shadow-sm border border-border-light overflow-hidden">
        <div class="p-8 text-center">
          <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
            <svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"></path>
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </div>
          <p class="text-text-muted">No documents have been uploaded for this client</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Dialog Actions -->
  <div class="flex justify-end p-6 border-t border-gray-200 bg-gray-50">
    <button (click)="onClose()" 
            class="btn btn-primary px-6 py-2 flex items-center gap-2">
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
      </svg>
      Close
    </button>
  </div>
</div>
