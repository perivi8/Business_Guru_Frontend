<!-- Dialog Header -->
<div class="flex items-center justify-between p-6 border-b border-gray-200 bg-gradient-to-r from-primary/5 to-primary-dark/5">
  <h2 class="text-xl font-bold text-gray-900 flex items-center gap-3">
    <div class="w-8 h-8 bg-primary/20 rounded-lg flex items-center justify-center">
      <mat-icon class="text-primary text-lg">account_balance</mat-icon>
    </div>
    Transactions for {{ data.client.legal_name || data.client.user_name || 'N/A' }}
  </h2>
</div>

<mat-dialog-content class="p-0 max-h-[80vh] overflow-y-auto">
  <!-- Add New Transaction Card -->
  <div class="p-6 bg-white border-b border-gray-100">
    <div class="bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl p-6 border border-green-200">
      <div class="flex items-center gap-3 mb-6">
        <div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center">
          <mat-icon class="text-green-600 text-lg">add_circle</mat-icon>
        </div>
        <h3 class="text-lg font-semibold text-gray-900">Add New Transaction</h3>
      </div>
      
      <form #transactionForm="ngForm" (ngSubmit)="addTransaction()" class="space-y-6">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <!-- Date Input -->
          <div class="w-full">
            <label class="block text-sm font-medium text-gray-700 mb-2">Date *</label>
            <div class="relative">
              <input type="date" 
                     [(ngModel)]="newTransaction.date" 
                     name="date" 
                     required
                     class="w-full px-3 py-3 border border-gray-300 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 hover:border-gray-400 transition-colors shadow-sm">
              <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                </svg>
              </div>
            </div>
          </div>

          <!-- Order ID Input -->
          <div class="w-full">
            <label class="block text-sm font-medium text-gray-700 mb-2">Order ID *</label>
            <div class="relative">
              <input type="text" 
                     [(ngModel)]="newTransaction.orderId" 
                     name="orderId" 
                     required 
                     placeholder="Enter order ID"
                     class="w-full px-3 py-3 border border-gray-300 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 hover:border-gray-400 transition-colors shadow-sm">
              <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 20l4-16m2 16l4-16M6 9h14M4 15h14"></path>
                </svg>
              </div>
            </div>
          </div>

          <!-- Amount Input -->
          <div class="w-full">
            <label class="block text-sm font-medium text-gray-700 mb-2">Amount *</label>
            <div class="relative">
              <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
                <span class="text-green-600 font-semibold text-lg">₹</span>
              </div>
              <input type="number" 
                     [(ngModel)]="newTransaction.amount" 
                     name="amount" 
                     required 
                     placeholder="0.00"
                     step="0.01"
                     min="0"
                     class="w-full pl-8 pr-3 py-3 border border-gray-300 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 hover:border-gray-400 transition-colors shadow-sm">
              <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path>
                </svg>
              </div>
            </div>
          </div>
        </div>

        <div class="flex justify-end">
          <button type="submit" 
                  [disabled]="!newTransaction.date || !newTransaction.orderId || !newTransaction.amount"
                  class="inline-flex items-center gap-2 px-6 py-3 bg-green-600 text-white font-medium rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 shadow-sm hover:shadow-md">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
            </svg>
            Add Transaction
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Transaction History Section -->
  <div class="p-6 bg-gray-50">
    <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
      <div class="flex items-center gap-3 p-6 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50">
        <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center">
          <mat-icon class="text-blue-600 text-lg">history</mat-icon>
        </div>
        <h3 class="text-lg font-semibold text-gray-900">Transaction History</h3>
      </div>
      
      <!-- Transaction Totals -->
      <div *ngIf="transactions.length > 0" class="p-6 bg-gradient-to-r from-purple-50 to-pink-50 border-b border-gray-200">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div class="bg-white rounded-lg p-4 border border-purple-200 shadow-sm">
            <div class="flex items-center justify-between">
              <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center">
                  <mat-icon class="text-purple-600">receipt_long</mat-icon>
                </div>
                <div>
                  <p class="text-sm text-gray-600">Total Transactions</p>
                  <p class="text-2xl font-bold text-purple-600">{{ getTotalTransactionCount() }}</p>
                </div>
              </div>
            </div>
          </div>
          
          <div class="bg-white rounded-lg p-4 border border-green-200 shadow-sm">
            <div class="flex items-center justify-between">
              <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center">
                  <mat-icon class="text-green-600">account_balance_wallet</mat-icon>
                </div>
                <div>
                  <p class="text-sm text-gray-600">Total Amount</p>
                  <p class="text-2xl font-bold text-green-600">₹{{ getTotalTransactionAmount() | number:'1.2-2' }}</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- No Transactions State -->
      <div *ngIf="transactions.length === 0" class="flex flex-col items-center justify-center py-12 text-gray-500">
        <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4">
          <mat-icon class="text-4xl text-gray-400">account_balance</mat-icon>
        </div>
        <p class="text-lg font-medium text-gray-600">No transactions found</p>
        <p class="text-sm text-gray-500">Add your first transaction above to get started</p>
      </div>

      <!-- Transactions Table -->
      <div *ngIf="transactions.length > 0" class="overflow-x-auto">
        <table mat-table [dataSource]="transactions" class="w-full">
          <!-- Date Column -->
          <ng-container matColumnDef="date">
            <th mat-header-cell *matHeaderCellDef class="bg-gray-50 text-gray-700 font-semibold py-4 px-6">Date</th>
            <td mat-cell *matCellDef="let transaction" class="py-4 px-6 border-b border-gray-100">
              <div class="flex items-center gap-2">
                <mat-icon class="text-blue-500 text-sm">calendar_today</mat-icon>
                <span class="font-medium text-gray-900">{{ transaction.date | date:'mediumDate' }}</span>
              </div>
            </td>
          </ng-container>

          <!-- Order ID Column -->
          <ng-container matColumnDef="orderId">
            <th mat-header-cell *matHeaderCellDef class="bg-gray-50 text-gray-700 font-semibold py-4 px-6">Order ID</th>
            <td mat-cell *matCellDef="let transaction" class="py-4 px-6 border-b border-gray-100">
              <div class="flex items-center gap-2">
                <mat-icon class="text-purple-500 text-sm">confirmation_number</mat-icon>
                <span class="font-mono text-sm bg-gray-100 px-2 py-1 rounded">{{ transaction.orderId }}</span>
              </div>
            </td>
          </ng-container>

          <!-- Amount Column -->
          <ng-container matColumnDef="amount">
            <th mat-header-cell *matHeaderCellDef class="bg-gray-50 text-gray-700 font-semibold py-4 px-6">Amount</th>
            <td mat-cell *matCellDef="let transaction" class="py-4 px-6 border-b border-gray-100">
              <div class="flex items-center gap-2">
                <mat-icon class="text-green-500 text-sm">currency_rupee</mat-icon>
                <span class="font-bold text-green-600 text-lg">₹{{ transaction.amount | number:'1.2-2' }}</span>
              </div>
            </td>
          </ng-container>

          <!-- Actions Column -->
          <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef class="bg-gray-50 text-gray-700 font-semibold py-4 px-6">Actions</th>
            <td mat-cell *matCellDef="let transaction" class="py-4 px-6 border-b border-gray-100">
              <button mat-icon-button (click)="deleteTransaction(transaction.id)" 
                      class="text-red-600 hover:bg-red-50 transition-colors duration-200 rounded-lg"
                      matTooltip="Delete Transaction">
                <mat-icon>delete</mat-icon>
              </button>
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="['date', 'orderId', 'amount', 'actions']" class="border-b border-gray-200"></tr>
          <tr mat-row *matRowDef="let row; columns: ['date', 'orderId', 'amount', 'actions'];" 
              class="hover:bg-gray-50 transition-colors duration-200"></tr>
        </table>
      </div>
    </div>
  </div>
</mat-dialog-content>

<!-- Dialog Actions -->
<div class="flex justify-end gap-3 p-6 border-t border-gray-200 bg-gray-50">
  <button mat-button (click)="onClose()" class="btn btn-outline px-6 py-2">
    <mat-icon class="mr-2">close</mat-icon>
    Close
  </button>
</div>